# 计算机组成原理（Computer Organization）应该这么学

## 1 计算机的基本组成

计算机组成原理的知识点可以分拆为四大部分：

- 计算机的基本组成
- 计算机的指令和计算
- 处理器设计
- 存储器和 I/O 设备

具体知识图谱：

![Computer Organization Knowledge Map](images/02-knowledge-map.jpg)

>熟记这张图中的知识点，能帮助我们建立计算机组成原理这门课程的基本概念。

关于这四个部分，我们具体需要掌握哪些知识呢？

### 计算机的基本组成

- 学习计算机是由哪些硬件组成的。
- 组成计算机的硬件是怎么对应到经典的冯·诺依曼体系结构中的，也就是`运算器、控制器、存储器、输入设备和输出设备`这五大基本组件。
- 了解计算机的两个核心指标，性能和功耗。性能和功耗是在应用和设计五大基本组件中需要重点考虑的因素。

### 计算机的指令和计算

在**计算机指令**部分，我们需要：

- 搞明白想 C、Java、PHP 这些程序是怎么在计算机里面运行，这又包括：
  - 了解程序是怎么通过编译器和汇编器，变成一条条机器指令这样的编译过程。（如果把编译过程展开可以变成一门完整的编译原理课程）
  - 了解操作系统怎么链接、装载、执行这些程序。（这部分知识如果再深入学习可以变成一门操作系统课程）

内存中的一条条指令执行的控制过程，是由计算机五大组件之一的控制器来控制的。

在**计算机的计算**部分，我们需要：

- 从二进制和编码开始，理解数据在计算机里的表示。
- 理解如何从数字电路层面，实现加法、乘法这些基本的运算功能。

实现运算功能的 ALU（Arithmetic Logic Unit/ALU），算术逻辑单元，是计算机五大组件之一的运算器。

其次**浮点数（Floating Point）**是一个重要的知识点，浮点数是我们在日常运用中非常容易用错的一种数据表示形式。掌握浮点数能让我们对数据的编码、存储和计算能够有一个从表到里的深入理解。尤其在 AI 火热的今天，浮点数是机器学习中重度使用的数据表示形式，掌握它更是非常有必要。

### CPU 的设计

- **CPU 时钟**可以用来构造寄存器和内存的锁存器和触发器，因此，CPU 时钟应该是学习 CPU 的前导知识。我们需要搞明白为什么需要 CPU 时钟（CPU Clock），以及寄存器和内存是用什么样的硬件组成的。
- **数据通路**连接了整个运算器和控制器，并最终组成了 CPU。我们需要掌握整个计算机的数据通路是如何构造出来的。
- 出于对于**性能和功耗**的考虑，我们需要进一步理解和掌握面向流水线设计的 CPU、数据和控制冒险，以及分支预测的相关技术。
- CPU 作为控制器要和输入输出设备通信，因此，我们还需要知道**异常和中断**发生的机制。
- 关于指令的并行执行，我们需要知道如何直接在 CPU 层面，通过 SIMD 来支持并行计算。

### 存储器的原理

- 通过存储器的层次结构作为基础的框架引导，我们需要掌握从上到下的 CPU 高速缓存、内存、SSD 硬盘和机械硬盘的工作原理，它们之间的性能差异，以及实际应用中利用这些设备会遇到的挑战。
- 存储器其实很多时候又扮演了输入输出设备的角色，所以我们需要进一步了解，CPU 和这些存储器之间是如何进行通信的，以及我们最重视的性能问题是怎么一回事；理解什么是 IO_WAIT，如何通过 DMA 来提升程序性能。
- 对于存储器，我们不仅需要它们能够正常工作，还要确保里面的数据不能丢失。因此我们还要掌握如何通过 RAID、Erasure Code、ECC 以及分布式 HDFS，这些不同的技术，来确保数据的完整性和访问性能。

## 2 如何学习

**1 学会提问自己来串联知识点**：

学完一个知识点之后，可以从下面两个方面，问一下自己。

- 我写的程序，是怎样从输入的代码，变成运行的程序，并得到最终结果的？
- 整个过程中，计算器层面到底经历了哪些步骤，有哪些地方是可以优化的？

**2 写一些示例程序来验证知识点**：

- 计算机组成中的大量原理和设计，都对应着“性能”这个词。因此，通过把对应的知识点，变成一个个性能对比的示例代码程序记录下来，是把这些知识点融汇贯通的好方法。

**3 通过和计算机硬件发展的历史做对照**：

- 现代计算机用的各个技术，都是跟随实际应用中遇到的挑战，一个个发明、打磨，最后保留下来的。这当中不仅仅有学术层面的碰撞，更有大量商业层面的交锋。通过了解充满戏剧性和故事性的计算机硬件发展史，让你更容易理解计算机组成中各种原理的由来。

## 3 学习资料

入门类：先对计算机组成原理这门课有个基本概念

- 《计算机是怎样跑起来的》
- 《程序是怎样跑起来的》
- 北京大学免费公开课 [Computer Organization](https://www.coursera.org/learn/jisuanji-zucheng)，介绍了硬件层面的基础实现，比如寄存器、ALU 这些电路是怎么回事。

深入学习书籍：深入掌握计算机组成

- 《计算机组成与设计：硬件 / 软件接口》
- 《深入理解计算机系统》
- [CSAPP 配套视频](https://www.bilibili.com/video/av24540152/)
- 《计算机组成：结构化方法》这本书的组织结构和其他教材都不太一样，适合作为一个辅助的参考书来使用。
- 《计算机体系结构：量化研究方法》

课外阅读：

- [What Every Programmer Should Know About Memory](chrome-extension://oemmndcbldboiebfnladdacbdfmadadm/https://people.freebsd.org/~lstewart/articles/cpumemory.pdf) 是写出高性能程序不可不读的经典材料
- [disruptor](https://lmax-exchange.github.io/disruptor/) 是通过实际应用程序，来理解计算机组成原理中各个知识点的最好范例
- 《编码：隐匿在计算机软硬件背后的语言》和《程序员的自我修养：链接、装载和库》是理解计算机硬件和操作系统层面代码执行的优秀阅读材料。
