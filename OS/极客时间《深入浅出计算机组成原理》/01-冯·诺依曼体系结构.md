# 冯·诺依曼体系结构

## 1 计算机的基本硬件组成

### 计算机的基本硬件组成：CPU、内存和主板

- **CPU 即中央处理器**（Central Processing Unit），它是计算机最重要的核心配件，计算机的所有“计算”都是由 CPU 来进行的。
- **内存**（Memory），你撰写的程序、打开的浏览器、运行的游戏，都要加载到内存里才能运行。程序读取的数据、计算得到的结果，也都要放在内存里。
- **主板**（Motherboard），存放在内存里的程序和数据，需要被 CPU 读取，CPU 计算完之后，还要把数据写回到内存。然而 CPU 不能直接插到内存上，反之亦然，CPU 与内存需要通过主板来进行通信，主板是一个有着各种各样，有时候多达数十乃至上百个插槽的配件。我们的 CPU 要插在主板上，内存也要插在主板上。主板的芯片组（Chipset）和总线（Bus）解决了 CPU 和内存之间如何通信的问题。芯片组控制了数据传输的流转，也就是数据从哪里到哪里的问题。总线则是实际数据传输的高速公路。因此，总线速度（Bus Speed）决定了数据能传输得多快。

### 其他部件

- **（Input）/ 输出（Output）设备**，也就是我们常说的I/O 设备。如果你用的是自己的个人电脑，那显示器肯定必不可少，只有有了显示器我们才能看到计算机输出的各种图像、文字，这也就是所谓的输出设备。同样的，鼠标和键盘也都是必不可少的配件。这样我才能输入文本，写下这篇文章。它们也就是所谓的输入设备。
- **硬盘**，绝大部分计算机都有应用，硬盘用来持久化存储数据。

显示器、鼠标、键盘和硬盘这些东西并不是一台计算机必须的部分，比如网盘的电脑主机中就没有硬盘，而是共享一个远程存储服务。

- **显卡**，使用图形界面操作系统的计算机，无论是 Windows、Mac OS 还是 Linux，显卡都是必不可少的。现在的主板都带了内置的显卡。但如果你用计算机玩游戏，做图形渲染或者跑深度学习应用，你就需要买一张单独的显卡，插在主板上。显卡里有除了 CPU 之外的另一个“处理器”，也就是GPU（Graphics Processing Unit，图形处理器），GPU 一样可以做各种“计算”的工作。

### 南桥与北桥

- **南桥**：鼠标、键盘以及硬盘，这些都是插在主板上的。作为外部 I/O 设备，它们是通过主板上的南桥（SouthBridge）芯片组，来控制和 CPU 之间的通信的。“南桥”芯片的名字很直观，一方面，它在主板上的位置，通常在主板的“南面”。另一方面，它的作用就是作为“桥”，来连接鼠标、键盘以及硬盘这些外部设备和 CPU 之间的通信。
- **北桥**：以前的主板上通常也有“北桥”芯片，用来作为“桥”，连接 CPU 和内存、显卡之间的通信。不过，随着时间的变迁，现在的主板上的“北桥”芯片的工作，已经被移到了 CPU 的内部，所以你在主板上，已经看不到北桥芯片了。

### System on a Chip（系统芯片）

手机里只有 SD 卡（Secure Digital Memory Card）这样类似硬盘功能的存储卡插槽，并没有内存插槽、CPU 插槽这些东西。没错，因为手机尺寸的原因，手机制造商们选择把 CPU、内存、网络通信，乃至摄像头芯片，都封装到一个芯片，然后再嵌入到手机主板上。这种方式叫SoC，也就是 System on a Chip（系统芯片）。

## 2 冯·诺依曼体系结构

PC 与个人手机在物理结构上存在着具体的差距，但是我们写的程序却可以无差别的运行在上面，这是因为无论是个人电脑、服务器、智能手机，还是 Raspberry Pi 这样的微型卡片机，都遵循着同一个“计算机”的抽象概念。——冯·诺依曼（John von Neumann）提出的冯·诺依曼体系结构（Von Neumann architecture），也叫存储程序计算机。

存储程序计算机暗含了两个概念，一个是 **“可编程”计算机**，一个是 **“存储”计算机**。

- 可编程计算机：相对于不可编程的计算机，比如功能固定的计算器，电路板设好了加减乘除，做不了任何计算逻辑固定之外的事情。
- 存储计算机：程序本身是存储在计算机的内存里，可以通过加载不同的程序来解决不同的问题。有“存储程序计算机”，自然也有不能存储程序的计算机。典型的就是早年的“Plugboard”这样的插线板式的计算机。

无论是“不可编程”还是“不可存储”，都会让使用计算机的效率大大下降。而这个对于效率的追求，也就是“存储程序计算机”的由来。于是冯·诺依曼基于当时在秘密开发的 EDVAC 写了一篇报告 [First Draft of a Report on the EDVAC](https://en.wikipedia.org/wiki/First_Draft_of_a_Report_on_the_EDVAC)，描述了他心目中的一台计算机应该长什么样。这篇报告在历史上有个很特殊的简称，叫 First Draft，翻译成中文，其实就是《第一份草案》。这样，现代计算机的发展就从冯·诺依曼写的一份草案开始了。

### First Draft 所描述的计算机

1. 一个包含算术逻辑单元（Arithmetic Logic Unit，ALU）和处理器寄存器（Processor Register）的处理器单元（Processing Unit），用来完成各种算术和逻辑运算。因为它能够完成各种数据的处理或者计算工作，因此也有人把这个叫作数据通路（Datapath）或者运算器。
2. 一个包含指令寄存器（Instruction Reigster）和程序计数器（Program Counter）的控制器单元（Control Unit/CU），用来控制程序的流程，通常就是不同条件下的分支和跳转。在现在的计算机里，上面的算术逻辑单元和这里的控制器单元，共同组成了我们说的 CPU。
3. 用来存储数据（Data）和指令（Instruction）的内存。以及更大容量的外部存储，在过去，可能是磁带、磁鼓这样的设备，现在通常就是硬盘。
4. 各种输入和输出设备，以及对应的输入和输出机制。

任何一台计算机的任何一个部件都可以归到**运算器、控制器、存储器、输入设备和输出设备**中，而所有的现代计算机也都是基于这个基础架构来设计开发的。

所有的计算机程序，也都可以抽象为从输入设备读取输入信息，通过运算器和控制器来执行存储在存储器里的程序，最终把结果输出到输出设备中。我们所有撰写的无论高级还是低级语言的程序，也都是基于这样一个抽象框架来进行运作的。

![Von Neumann architecture](images/01-vna.jpeg)

## 3 计算机组成原理学的是什么？

学习组成原理，其实就是学习

- 控制器、运算器的工作原理，也就是 CPU 是怎么工作的，以及为何这样设计；
- 学习内存的工作原理，从最基本的电路，到上层抽象给到 CPU 乃至应用程序的接口是怎样的；
- 学习 CPU 是怎么和输入设备、输出设备打交道的。

学习组成原理，就是在理解从控制器、运算器、存储器、输入设备以及输出设备，从电路这样的硬件，到最终开放给软件的接口，是怎么运作的，为什么要设计成这样，以及在软件开发层面怎么尽可能用好它。

## 4 图灵机（Turing Machine）

图灵机（英语：Turing machine），又称确定型图灵机，是英国数学家艾伦·图灵于1936年提出的一种抽象计算模型，其更抽象的意义为一种数学逻辑机，可以看作等价于任何有限逻辑数学过程的终极强大逻辑机器。——[《维基百科-图灵机》](https://zh.wikipedia.org/wiki/%E5%9B%BE%E7%81%B5%E6%9C%BA)

图灵机能解决的问题的范围是：

- 所有有解的数学问题
- 能通过有限的计算步骤得到答案的数学问题
