类和接口是Java程序设计语言的核心，也是Java最基本的抽象单元，在类与接口章节阐述一些知道原则，设计出更加有用，健壮和灵活的类和接口。

---
# 第13条：使类和成员的可访问性最小化

**要区别设计良好的模块与设计不好的模块，最重要的因素在于，这个模块对于外部的其他模块而言，是否可访问其内部数据和其他实现细节。**
设计良好的模块会隐藏所有的实现细节，把他的API与实现细节清晰的隔离出来，然后模块与模块之间只通过他们的API进行通信。这个概念称之为**信息隐藏(information hiding)**或**封装(encapsulation)**

- 有效的接触组成系统的各模块之间的耦合关系(模块可以独立开发，测试，优化，使用，理解，修改)
- 有效的调节性能(模块的优化不影响其他模块)
- 降低构建大型系统的风险(独立模块可用)

所以： **尽可能使每个类或者成员不被外界访问**


## 具体规则

###  对于顶层的类和接口，只可能有两种访问级别：**包级私有**和**共有的**

- 如果能把类或者接口做出包级私有的，它们就应该是包级私有的，此时它们只是这个包的实现的一部分，而包外无法访问它们，也不知道他们的存在，在之后的迭代中，对它们进行删除，修改，替换，或者删除不会影响包外其他模块
- 如果类和接口被做成公有的，那么开发者有责任用于支持它，以保持兼容性。
- 如果一个包级私有类或接口只是在某一个类的内部被使用， 就应该考虑使它成为使用它的类的私有嵌套类，这样可以进一步缩小它的可访问性。

### 对于成员（域，方法，嵌套类，嵌套接口）有四种访问级别

- private的，只有类的内部才能访问
- 包级私有的(即没有添加访问修饰关键字，则为缺省(default)的访问级别)
- protected的，同包和子类可以访问
- public的，任何地方都可以访问

当访问级别从包级私有变成受保护级别时，会大大增加可访问性，受包含的成员也代表了改类对某个实现细节的公开承诺，受保护的成员应该尽量少用。

### 实例域绝不能是共有的

如果一个域是非final的，或者是一个指向可变对象的final应用，一旦它使这个域成为共有的，就意味着**放弃了存储在这个域中的值进行限制的可能性**，当这个域被修改时，你也就失去了对它采取任何行动的能力。
**因此：包含共有可变域的类并不是线程安全的**，同时意味着放弃了切换到一种新的内部数据的表示法的灵活性

同样的建议也适用于静态，只用一种列外：**即常量构成了类提供的整个抽象中的一部分，可以通过公有的静态final域来暴露**，同时它应该有以下特点：
- 常量的惯用命名方式
- 这个域包含的是基本数据类型或者引用的是不可变对象


## 示例

类具有共有的静态final数组域，或者返回这种域的方法，这几乎总是错误的。

```
    public static final A[] VALUES = {};
    
        public A[]  getValues() {
            return VALUES;
        }
```

如果需要别外界访问，有两种实现方式：

暴露不可变域

```java
        private static final A[] PRIVATE_VALUES = {};
        //但是返回的不可变列表虽然是只读的，但是对于列表中的单个元素依然是可以被外界修改的。
        public static final List<A> VALUES =        
        Collections.unmodifiableList(Arrays.asList(PRIVATE_VALUES));
```

返回原有域的拷贝。

```java
        private static final A[] PRIVATE_VALUES = {};
    
        public static final A[] getValues() {
            return PRIVATE_VALUES.clone();
        }
```


---
# 第14条：在公有类中使用访问方法而非公用域

比如有如下类：

```
    class Point{
        public float x;
        public float y;
    }
```

这种类的数据可以被直接访问，无法对数据的改变强加任何约束，当域被访问时，无法采取任何辅助行为，**坚持面向对象程序设计的程序员应该对这种类深恶痛绝**，所以我们应该提供访问域的方法：

```java
    class Point{
        private float x;
        private float y;
    
        public float getX() {
            return x;
        }
    
        public void setX(float x) {
            this.x = x;
        }
    
        public float getY() {
            return y;
        }
    
        public void setY(float y) {
            this.y = y;
        }
    }
```

坚持面向对象程序设计思想的看法是：

- 如果类可以在它所在包外部进行访问，就提供方法，以保留将来改变该类的内部表示非的灵活性，如果共有泪暴露了它的数据域，要想在将来改变其内部表示发誓不可能的，因为公有类的客户端代码已经遍布各处了然而，
- 如果类是包级私有的，或者是私有的嵌套类，直接暴露它的数据域并没有本质的错误。
- 总之：共有类永远都不应该暴露可变的域。
