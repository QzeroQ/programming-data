# 密码学简介

密码学是一门通信安全的科学，总的来说，密码学已经有两千多年的历史了。

部署正确的密码能够解决三个核心需求：

- 保持秘密（机密性）
- 验证身份（真实性）
- 保护传输安全（完整性）

>如果想深入学习密码学，推荐阅读《深入浅出密码学》、《图解密码技术》。

---
## 1 构建基块

在最底层，使用密码依赖于各种加密基元（cryptographic primitive），每种基元都着眼于解决某个特定的问题，比如使用某个基元加密，而使用两个基元来验证完整性，单个基元本身的作用不大，但我们可以将它们组合 **方案（scheme）** 和 **协议（protocol）**，从而提供可靠的安全性。

### 对称密码

对称密钥加密（英语：Symmetric-key algorithm）又称为对称加密、私钥加密、共享密钥加密，是密码学中的一类加密算法。这类算法在加密和解密时使用相同的密钥。

对称加密可以追溯到上千年以前，当时的密码不存在密钥，安全性取决于保守加密方法的秘密，而现在对称加密采用的方法，来自 19 世纪的一位密码学家 Auguste Kerckhoffs 的观察结果发展而来：**即使攻击者知晓了整个密码系统除密钥以外的所有情报**，系统仍然能够保证安全。原因如下：

- 如果一种加密算法要得到广泛应用，就必须让其他人知道，当越来越多的人接触到这个算法，那么敌人得到这个算法的可能性也会增加。
- 没有密钥的算法非常不便于在大群体中使用，每个人都可以解密所有人的通信。
- 设计出优秀的加密算法非常困难，一种算法想要更安全，就得经过更多的曝光和审视，当需要采用一种新算法时，密码学家推荐使用保守的方法来确定密码是否安全，那就是算法需要经过许多年的破解尝试。

如果密码算法设计非常优秀，那么只有一种方法可以破解它——穷举密钥搜索（exhaustive key search）。基于这一点，我们可以说密文的安全性完全取决于密钥，如果密钥是从非常大的空间选取的，那么破解需要遍历几乎所有这些可能的密钥，其基数巨大，几乎不可能，我们可以说这种算法在计算上时安全性的。

密码可以分为两大类：序列密码和分组密码：

### 散列函数

散列函数（hash function）就是将任意长度的输入转换为固定长度的输出的算法，其输出就哦简称为 **散列（hash）**，编程中使用的散列算法并不普遍适用于密码学，密钥学要求散列函数有以下额外的特性：

- 抗原像性：无法根据给定的散列计算或者构造出生成它的消息
- 抗第二原像性（抗弱碰撞行）：给定一个消息和散列，计算上无法找到一条不同的消息具有相同的散列
- 抗强碰撞行：计算上无法找到两条散列相同的消息

散列函数的使用场景是以紧凑的数据来比较数据量较大的数据，以此来避免直接比较原数据，散列常被称为 **指纹**，**消息摘要**，或者简称 **摘要**。

使用最为广泛的散列函数:

- sha1：已经变弱，不建议使用了。
- sha256

### 消息验证码

散列函数用于验证数据的 **完整性**，但仅在数据的散列和数据本身分开传输的时候如此，否者攻击者可以同时修改数据和数据的散列，从而避开检测。消息验证码（message authentication code, MAC）或使用 **密钥的散列(keyed-hash)**是以身份验证扩展了散列函数的密码学函数，**只有拥有散列密钥，才能生成合法的 MAC**。MAC 通常与加密一起使用，当 MAC 与 密文被一起传输的时候，就能确认消息是否被篡改了。即提供了数据的完整性。

### 分组密码模式

分组密码模式是为了加密任意长度的数据而设计的密码学方案，是对分组密码的扩展。常用的分组模式有：ECB、CBC、CFB、OFB、CTR、GCM。

- ECB：电话本模式，最简单的模式，容易被破解，不建议使用
- CBC：加密块链接欸模式。

### 非对称加密

对称加密在高速处理大量数据方便具有加好的性能，然而随着使用它的团体增加，产生了更多的需求，使得对称加密无法满足：

- 相同团体成员必须使用相同的密钥，人越多，团体密钥出现的问题的次数就越多。
- 为了安全性，可以在每两个人之间使用不同密钥，但这样的扩展性不高，想象一下，10 个人需要 45(1+2+...+9) 把公钥，1000个人需要 499500 个密钥。而且每个人要为其他 999 个人维护着公钥列表。
- 对称加密不能用于访问安全数据的无人系统，因为使用相同的密钥可以反转整个系统，这样的系统出现任何问题都会影响到存储在这个系统中所有的数据。

非对称加密（asymmetric encryption）又称公钥加密（publick-key enryption），使用两个密钥：公钥和密钥。公钥加密的数据只能被私钥解开，而私钥加密的数据也只能被公钥解开。非对称加密使得大规模团体的安全通信大幅简化。

非对称加密通用存在着问题：它非常缓慢，不适用于大量数据的场景，它往往被部署于进行身份验证和贡献秘密的协商。RAS（三位发明者的姓氏首字母）是目前最常用的非对称加密算法，现在推荐的 RSA 强度是 2048 位，强度等同于 112 位的对称密钥。

### 数字签名

### 随机数生成

---
## 2 协议

---
## 3 攻击密码

---
## 4 衡量强度

---
## 5 中间人攻击

### 取得访问权
### 被动攻击
### 主动攻击